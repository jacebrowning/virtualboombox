version: 2

executorType: docker

containerInfo:
  - image: python:3.6.9
  - image: postgres:9.6.1

stages:
  build:
    workDir: /home/ubuntu/virtualboombox
    environment:
      PIPENV_NOSPIN: true
    steps:
      - type: checkout
      - type: shell
        command: pip install pipenv
      - type: shell
        command: make doctor
      - type: shell
        command: make install
      - type: shell
        command: make check
      - type: shell
        command: make test
        # TODO: get reports working with CircleCI 2.0
